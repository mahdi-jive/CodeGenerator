@using CodeGenerator.Assembly.Template.NetTiers.Extensions
@model CodeGenerator.Assembly.Template.NetTiers.Model.DatabaseInfo.Table.ITable
@{

	var summaryText = string.IsNullOrEmpty(Model.Description)
		? $"An object representation of the '{Model.Name}' table. [No description found in the database]"
		: Model.Description;

	var columns = await Model.Columns;

}

/*
	File generated by Rapco templates [www.Rapco-rpk.com]
	Important: Do not modify this file. Edit the file @(Model.NamePascal).cs instead.
*/

#region using directives
using System;
using System.ComponentModel;
using System.Collections;
using System.Web.Script.Serialization;
using System.Xml.Serialization;
using System.Runtime.Serialization;
using System.ComponentModel.DataAnnotations;
using Behsaz.Entities.Validation;
#endregion

namespace Behsaz.Entities
{
	///<summary>
	/// @summaryText
	///</summary>
	[Serializable]
	[DataObject, CLSCompliant(true)]
	public abstract partial class @(Model.NamePascal)Base : EntityBase, I@(Model.NamePascal), IEntityId<@(Model.NamePascal)Key>, System.IComparable, System.ICloneable, ICloneableEx, IEditableObject, IComponent, INotifyPropertyChanged
	{
		#region Variable Declarations

		/// <summary>
		///  Hold the inner data of the entity.
		/// </summary>
		private @(Model.NamePascal)EntityData entityData;

		/// <summary>
		/// 	Hold the original data of the entity, as loaded from the repository.
		/// </summary>
		private @(Model.NamePascal)EntityData _originalData;

		/// <summary>
		/// 	Hold a backup of the inner data of the entity.
		/// </summary>
		private @(Model.NamePascal)EntityData backupData;

		/// <summary>
		/// 	Key used if Tracking is Enabled for the <see cref="EntityLocator" />.
		/// </summary>
		private string entityTrackingKey;

		/// <summary>
		/// 	Hold the parent TList&lt;entity&gt; in which this entity maybe contained.
		/// </summary>
		/// <remark>Mostly used for databinding</remark>
		[NonSerialized]
		private TList<@(Model.NamePascal)> parentCollection;

		private bool inTxn = false;

		/// <summary>
		/// Occurs when a value is being changed for the specified column.
		/// </summary>
		[field:NonSerialized]
		public event @(Model.NamePascal)EventHandler ColumnChanging;

		/// <summary>
		/// Occurs after a value has been changed for the specified column.
		/// </summary>
		[field:NonSerialized]
		public event @(Model.NamePascal)EventHandler ColumnChanged;
		#endregion Variable Declarations
	
		#region Constructors
		///<summary>
		/// Creates a new <see cref="@(Model.NamePascal)Base" /> instance.
		/// </summary>
		public @(Model.NamePascal)Base()
		{
			this.entityData = new @(Model.NamePascal)EntityData();
			this.backupData = null;
		}

		///<summary>
		/// Creates a new <see cref="@(Model.NamePascal)Base" /> instance.
		///</summary>
@foreach (var item in columns)
{
	@:		///		<param name="_@(item.NameCamel)"></param>
}

		public @(Model.NamePascal)Base(@(await Model.ToColumnsFieldList()))
		{
			this.entityData = new @(Model.NamePascal)EntityData();
			this.backupData = null;
@foreach (var item in columns)
{

	@:		this.@(item.NamePascal)=_@(item.NameCamel)
}
		}
		///<summary>
		/// A simple factory method to create a new <see cref="@(Model.NamePascal)" /> instance.
		///</summary>
@foreach (var item in columns)
{
	@:		///		<param name="_@(item.NameCamel)"></param>
}
		public static @(Model.NamePascal) Create@(Model.NamePascal)(@(await Model.ToColumnsFieldList()))
		{
			@(Model.NamePascal) new@(Model.NamePascal) = new @(Model.NamePascal)();
@foreach (var item in columns)
{

	@:		new@(Model.NamePascal).@(item.NamePascal)=_@(item.NameCamel)
}
			return new@(Model.NamePascal);
		}

		#endregion Constructors

		#region Properties

		#region Data Properties
@foreach (var item in columns)
{
	@:		/// <summary>
	@:		/// 	Gets or sets the @(item.NamePascal) property.
	@:		/// 	@(item.Description)
	@:		///</summary>
	@:		/// <value>This type is @(item.DataType).</value>
	@:		/// <remarks>
	if (item.IsNullable)
	{
		@:		/// This property can be set to null.
		@:		/// If this column is null it is up to the developer to check using the HasValue property
		@:		/// and perform business logic appropriately.	
		@:
		@:
		@:
		@:
		@:[XmlElement(IsNullable=true)]
	}
	else
	{
		@:		/// This property can not be set to null.
		@:
		@:		[Required(ErrorMessage = "@item.NamePascal is required")]
		@:
		@:
		@:
		@:
	}
	if (item.IsPrimaryKey)
	{
		@:		[ReadOnlyAttribute(false)/*, XmlIgnoreAttribute()*/, DescriptionAttribute(@@"@item.Description"), System.ComponentModel.Bindable( System.ComponentModel.BindableSupport.Yes)]
	}
	else
	{
		@:		[DescriptionAttribute(@@"@(item.Description)"), System.ComponentModel.Bindable( System.ComponentModel.BindableSupport.Yes)]
	}
	@:      [DataObjectField(@item.IsPrimaryKey.ToString().ToLower(), @item.IsIdentity.ToString().ToLower(), @item.IsNullable.ToString().ToLower())]
	@:	public virtual @item.CSharpType @(item.NamePascal)
	@:	{
	@:		get
	@:		{
	@:			return this.entityData.@(item.NamePascal); 
	@:		}
	@:		
	@:		set
	@:		{
	@:			if (this.entityData.@(item.NamePascal) == value)
	@:				return;
	@:			
    @:            OnPropertyChanging("@(item.NamePascal)");                    
	@:			OnColumnChanging(@(Model.NamePascal)Column.@(item.NamePascal), this.entityData.@(item.NamePascal));
	@:			this.entityData.@(item.NamePascal) = value;
	@:			if (this.EntityState == EntityState.Unchanged)
	@:				this.EntityState = EntityState.Changed;
	@:			OnColumnChanged(@(Model.NamePascal)Column.@(item.NamePascal), this.entityData.@(item.NamePascal));
	@:			OnPropertyChanged("@(item.NamePascal)");
	@:		}
	@:	}
}
		#endregion
			
	} // End Class

	#region @(Model.NameCamel)EventArgs class
	/// <summary>
	/// Provides data for the ColumnChanging and ColumnChanged events.
	/// </summary>
	/// <remarks>
	/// The ColumnChanging and ColumnChanged events occur when a change is made to the value 
	/// of a property of a <see cref="@(Model.NameCamel)"/> object.
	/// </remarks>
	public class @(Model.NameCamel)EventArgs : System.EventArgs
	{
		private @(Model.NameCamel)Column column;
		private object value;
		
		///<summary>
		/// Initalizes a new Instance of the @(Model.NameCamel)EventArgs class.
		///</summary>
		public @(Model.NameCamel)EventArgs(@(Model.NameCamel)Column column)
		{
			this.column = column;
		}
		
		///<summary>
		/// Initalizes a new Instance of the @(Model.NameCamel)EventArgs class.
		///</summary>
		public @(Model.NameCamel)EventArgs(@(Model.NameCamel)Column column, object value)
		{
			this.column = column;
			this.value = value;
		}
		
		///<summary>
		/// The @(Model.NameCamel)Column that was modified, which has raised the event.
		///</summary>
		///<value cref="@(Model.NameCamel)Column" />
		public @(Model.NameCamel)Column Column { get { return this.column; } }
		
		/// <summary>
        /// Gets the current value of the column.
        /// </summary>
        /// <value>The current value of the column.</value>
		public object Value{ get { return this.value; } }

	}
	#endregion
	
	///<summary>
	/// Define a delegate for all @(Model.NameCamel) related events.
	///</summary>
	public delegate void @(Model.NameCamel)EventHandler(object sender, @(Model.NameCamel)EventArgs e);
	
	#region @(Model.NameCamel)Comparer
		
	/// <summary>
	///	Strongly Typed IComparer
	/// </summary>
	public class @(Model.NameCamel)Comparer : System.Collections.Generic.IComparer<@(Model.NameCamel)>
	{
		@(Model.NameCamel)Column whichComparison;
		
		/// <summary>
        /// Initializes a new instance of the <see cref="T:@(Model.NameCamel)Comparer"/> class.
        /// </summary>
		public @(Model.NameCamel)Comparer()
        {            
        }               
        
        /// <summary>
        /// Initializes a new instance of the <see cref="T:@(Model.NameCamel)Comparer"/> class.
        /// </summary>
        /// <param name="column">The column to sort on.</param>
        public @(Model.NameCamel)Comparer(@(Model.NameCamel)Column column)
        {
            this.whichComparison = column;
        }

		/// <summary>
        /// Determines whether the specified <see cref="@(Model.NameCamel)"/> instances are considered equal.
        /// </summary>
        /// <param name="a">The first <see cref="@(Model.NameCamel)"/> to compare.</param>
        /// <param name="b">The second <c>@(Model.NameCamel)</c> to compare.</param>
        /// <returns>true if objA is the same instance as objB or if both are null references or if objA.Equals(objB) returns true; otherwise, false.</returns>
        public bool Equals(@(Model.NameCamel) a, @(Model.NameCamel) b)
        {
            return this.Compare(a, b) == 0;
        }

		/// <summary>
        /// Gets the hash code of the specified entity.
        /// </summary>
        /// <param name="entity">The entity.</param>
        /// <returns></returns>
        public int GetHashCode(@(Model.NameCamel) entity)
        {
            return entity.GetHashCode();
        }

        /// <summary>
        /// Performs a case-insensitive comparison of two objects of the same type and returns a value indicating whether one is less than, equal to, or greater than the other.
        /// </summary>
        /// <param name="a">The first object to compare.</param>
        /// <param name="b">The second object to compare.</param>
        /// <returns></returns>
        public int Compare(@(Model.NameCamel) a, @(Model.NameCamel) b)
        {
        	EntityPropertyComparer entityPropertyComparer = new EntityPropertyComparer(this.whichComparison.ToString());
        	return entityPropertyComparer.Compare(a, b);
        }

		/// <summary>
        /// Gets or sets the column that will be used for comparison.
        /// </summary>
        /// <value>The comparison column.</value>
        public @(Model.NameCamel)Column WhichComparison
        {
            get { return this.whichComparison; }
            set { this.whichComparison = value; }
        }
	}
	
	#endregion
	
	#region @(Model.NameCamel)Key Class

	/// <summary>
	/// Wraps the unique identifier values for the <see cref="@(Model.NameCamel)"/> object.
	/// </summary>
	[Serializable]
	[CLSCompliant(true)]
	public class @(Model.NameCamel)Key : EntityKeyBase
	{
		@{
			var primaryKey = columns.FirstOrDefault(q => q.IsPrimaryKey);
				if (primaryKey==null)
				{
					throw new NullReferenceException(Model.Name);
				}
		}
		#region Constructors
		
		/// <summary>
		/// Initializes a new instance of the @(Model.NameCamel)Key class.
		/// </summary>
		public @(Model.NameCamel)Key()
		{
		}
		
		/// <summary>
		/// Initializes a new instance of the @(Model.NameCamel)Key class.
		/// </summary>
		public @(Model.NameCamel)Key(@(Model.NameCamel)Base entity)
		{
			this.Entity = entity;

			#region Init Properties

			if ( entity != null )
			{
				this.@primaryKey.NamePascal = entity.@primaryKey.NamePascal;
			}

			#endregion
		}
		
		/// <summary>
		/// Initializes a new instance of the @(Model.NameCamel)Key class.
		/// </summary>
		public @(Model.NameCamel)Key(System.Int32 _@primaryKey.NameCamel)
		{
			#region Init Properties

			this.@primaryKey.NamePascal = _@primaryKey.NameCamel;

			#endregion
		}
		
		#endregion Constructors

		#region Properties
		
		// member variable for the Entity property
		private @(Model.NameCamel)Base _entity;
		
		/// <summary>
		/// Gets or sets the Entity property.
		/// </summary>
		public @(Model.NameCamel)Base Entity
		{
			get { return _entity; }
			set { _entity = value; }
		}
		
		// member variable for the @primaryKey.NamePascal property
		private @primaryKey.CSharpType _@primaryKey.NameCamel;
		
		/// <summary>
		/// Gets or sets the @primaryKey.NamePascal property.
		/// </summary>
		public @primaryKey.CSharpType @primaryKey.NamePascal
		{
			get { return _@primaryKey.NameCamel; }
			set
			{
				if ( this.Entity != null )
					this.Entity.@primaryKey.NamePascal = value;
				
				_@primaryKey.NameCamel = value;
			}
		}
		
		#endregion

		#region Methods
		
		/// <summary>
		/// Reads values from the supplied <see cref="IDictionary"/> object into
		/// properties of the current object.
		/// </summary>
		/// <param name="values">An <see cref="IDictionary"/> instance that contains
		/// the key/value pairs to be used as property values.</param>
		public override void Load(IDictionary values)
		{
			#region Init Properties

			if ( values != null )
			{
				Id = ( values["@primaryKey.NamePascal"] != null ) ? (@primaryKey.CSharpType) EntityUtil.ChangeType(values["@primaryKey.NamePascal"], typeof(@primaryKey.CSharpType)) : (int)0;
			}

			#endregion
		}

		/// <summary>
		/// Creates a new <see cref="IDictionary"/> object and populates it
		/// with the property values of the current object.
		/// </summary>
		/// <returns>A collection of name/value pairs.</returns>
		public override IDictionary ToDictionary()
		{
			IDictionary values = new Hashtable();

			#region Init Dictionary

			values.Add("@primaryKey.NamePascal", @primaryKey.NamePascal);

			#endregion Init Dictionary

			return values;
		}
		
		///<summary>
		/// Returns a String that represents the current object.
		///</summary>
		public override string ToString()
		{
			return String.Format("@primaryKey.NamePascal: {0}{1}",
								@primaryKey.NamePascal,
								System.Environment.NewLine);
		}

		#endregion Methods
	}
	
	#endregion	

	#region @(Model.NameCamel)Column Enum
	
	/// <summary>
	/// Enumerate the @(Model.NameCamel) columns.
	/// </summary>
	[Serializable]
	public enum @(Model.NameCamel)Column : int
	{
			
		@for (int i = 0; i <columns.Count(); i++)
			{
				var item = columns.ElementAt(i);
				@:		/// <summary>
				@: 		/// @item.NamePascal : @item.Description
				@: 		/// </summary>
				@:		[EnumTextValue("@item.NamePascal")]
				@:		[ColumnEnum("@item.Name", typeof(@item.CSharpType), System.Data.@item.DbType, @item.IsPrimaryKey.ToString().ToLower(), @item.IsIdentity.ToString().ToLower(), @item.IsNullable.ToString().ToLower())]
				@:		[EnumTextValue("@item.NamePascal")]
				@:		@item.NamePascal = 1
			}
	}//End enum

	#endregion @(Model.NameCamel)Column Enum

} // end namespace
	